-- create table karyawan(
-- 	id serial primary key,
-- 	nama text,
-- 	umur int
-- )

-- select * from karyawan

-- insert into karyawan(nama, umur)
-- values
-- ('Adam',33),
-- ('Adam',33),
-- ('Willi',31),
-- ('Andra',30)


-- select * from pegawai

-- insert into pegawai(umur, nama_pegawai) values (27,'Wawan')

-- --ubah kolom table ke auto increment
-- alter table pegawai alter column id_pegawai add generated by default as identity
-- --restart increment ke number tertentu
-- alter sequence pegawai_id_pegawai_seq restart with 4

-- create table kota(
-- 	id serial primary key,
-- 	nama text,
-- 	id_propinsi int
-- )

-- create table propinsi(
-- 	id serial primary key,
-- 	nama text
-- )

-- insert into kota(nama, id_propinsi)
-- values
-- ('Jakarta',1),
-- ('Bandung',2),
-- ('Sumedang',3),
-- ('Makasar',4),
-- ('Surabaya',5),
-- ('Medan',6)

-- update kota set id_propinsi = 2 where id = 3

-- select * from kota order by id

-- insert into propinsi(nama)
-- values
-- ('DKI Jakarta'),
-- ('Jawa Barat'),
-- ('Papua Barat'),
-- ('Sulawesi Selatan'),
-- ('Jawa Timur')

-- select * from propinsi

-- --inner join
-- select * from kota join propinsi on kota.id_propinsi = propinsi.id order by kota.id

-- --left join
-- select kota.id, kota.nama as "Kota",propinsi.id, propinsi.nama as "Propinsi" from kota 
-- left join propinsi on kota.id_propinsi = propinsi.id order by kota.id

-- --right join
-- select kota.id, kota.nama as "Kota",propinsi.id, propinsi.nama as "Propinsi" from kota 
-- right join propinsi on kota.id_propinsi = propinsi.id order by kota.id

-- --full outer join
-- select kota.id, kota.nama as "Kota",propinsi.id, propinsi.nama as "Propinsi" from kota 
-- full outer join propinsi on kota.id_propinsi = propinsi.id order by kota.id

-- --wild
-- select * from kota, propinsi where kota.id = propinsi.id

-- CREATE TABLE public.artis (
--     kd_artis character varying(5) NOT NULL,
--     nm_artis character varying(50),
--     jk character varying(10),
--     bayaran integer,
--     award integer,
--     negara character varying(5)
-- );
-- INSERT INTO public.artis (kd_artis, nm_artis, jk, bayaran, award, negara) VALUES ('A001', 'ROBERT DOWNEY JR', 'PRIA', 1000000000, 2, 'AS');
-- INSERT INTO public.artis (kd_artis, nm_artis, jk, bayaran, award, negara) VALUES ('A003', 'JACKIE CHAN', 'PRIA', 1200000000, 7, 'HK');
-- INSERT INTO public.artis (kd_artis, nm_artis, jk, bayaran, award, negara) VALUES ('A004', 'JOE TASLIM', 'PRIA', 350000000, 1, 'ID');
-- INSERT INTO public.artis (kd_artis, nm_artis, jk, bayaran, award, negara) VALUES ('A005', 'CHELSEA ISLAN', 'WANITA', 300000000, 0, 'ID');
-- INSERT INTO public.artis (kd_artis, nm_artis, jk, bayaran, award, negara) VALUES ('A002', 'ANGELINA JOLIE', 'WANITA', 700000000, 1, 'AS');


-- CREATE TABLE public.genre (
--     kd_genre character varying(5) NOT NULL,
--     nm_genre character varying(50)
-- );

-- INSERT INTO public.genre (kd_genre, nm_genre) VALUES ('G001', 'ACTION');
-- INSERT INTO public.genre (kd_genre, nm_genre) VALUES ('G002', 'HORROR');
-- INSERT INTO public.genre (kd_genre, nm_genre) VALUES ('G003', 'COMEDY');
-- INSERT INTO public.genre (kd_genre, nm_genre) VALUES ('G004', 'DRAMA');
-- INSERT INTO public.genre (kd_genre, nm_genre) VALUES ('G005', 'THRILER');
-- INSERT INTO public.genre (kd_genre, nm_genre) VALUES ('G006', 'FICTION');



-- CREATE TABLE public.negara (
--     kd_negara character varying(5) NOT NULL,
--     nm_negara character varying(50)
-- );
-- INSERT INTO public.negara (kd_negara, nm_negara) VALUES ('AS', 'AMERIKA SERIKAT');
-- INSERT INTO public.negara (kd_negara, nm_negara) VALUES ('HK', 'HONGKONG');
-- INSERT INTO public.negara (kd_negara, nm_negara) VALUES ('ID', 'INDONESIA');
-- INSERT INTO public.negara (kd_negara, nm_negara) VALUES ('IN', 'INDIA');

-- CREATE TABLE public.produser (
--     kd_produser character varying(5) NOT NULL,
--     nm_produser character varying(50),
--     international character varying(10)
-- );
-- INSERT INTO public.produser (kd_produser, nm_produser, international) VALUES ('PD01', 'MARVEL', 'YA');
-- INSERT INTO public.produser (kd_produser, nm_produser, international) VALUES ('PD02', 'HONGKONG CINEMA', 'YA');
-- INSERT INTO public.produser (kd_produser, nm_produser, international) VALUES ('PD03', 'RAPI FILM', 'TIDAK');
-- INSERT INTO public.produser (kd_produser, nm_produser, international) VALUES ('PD04', 'PARKIT FILM', 'TIDAK');
-- INSERT INTO public.produser (kd_produser, nm_produser, international) VALUES ('PD05', 'PARAMOUNT PICTURE', 'YA');

select * from produser
select * from genre
select * from artis
select * from film
select * from negara

--14 tampilkan nama film dan artisnya
select nm_film, nm_artis from film join artis on film.artis = artis.kd_artis
--15 tampilkan film yg artisnya berasal dari negara HONGKONG
select nm_film from film 
inner join artis on film.artis = artis.kd_artis 
inner join negara ON negara.kd_negara = artis.negara
where negara.nm_negara = 'HONGKONG'
--16 tampilkan nama film yg artisnya berasal dr negara yg tidak mengandung huruf 'o'
select nm_film,negara.nm_negara from film 
inner join artis on film.artis = artis.kd_artis 
inner join negara ON negara.kd_negara = artis.negara
where lower(negara.nm_negara) NOT LIKE lower('%o%')
--17 tampilkan nama film dan artis yg memiliki award terbanyak
select nm_film, nm_artis, award from film 
join artis on film.artis = artis.kd_artis
where award = (
select max(award) from artis join film on film.artis = artis.kd_artis
)
--18 tampilkan nama film dengan artis bayaran terendah
select nm_film,nm_artis,bayaran from film 
join artis on film.artis = artis.kd_artis
where bayaran = (
select min(bayaran) from artis join film on film.artis = artis.kd_artis
)
--19 tampilkan nama artis yg tidak pernah bermain film
select artis.nm_artis from film 
right join artis on film.artis = artis.kd_artis 
group by nm_artis
having count(film.nm_film) = 0

--20 tampilkan nama artis yg bermain film dengan genre drama
select artis.nm_artis,film.nm_film, genre.nm_genre from film 
join artis on film.artis = artis.kd_artis 
join genre on film.genre = genre.kd_genre
where lower(genre.nm_genre) = lower('drama')

--21 tampilkan nama artis yg bermain film dengan genre horror
select artis.nm_artis,film.nm_film, genre.nm_genre from film 
join artis on film.artis = artis.kd_artis 
join genre on film.genre = genre.kd_genre
where lower(genre.nm_genre) = lower('horror')

--22 tampilkan data negara dengan jumlah filmnya
select negara.nm_negara, count(film.nm_film) from film 
join artis on film.artis = artis.kd_artis 
right join negara on artis.negara = negara.kd_negara
group by negara.nm_negara

--23 tampilkan nama artis yg paling banyak bermain film
select artis.nm_artis,count(film.nm_film) from film 
right join artis on film.artis = artis.kd_artis 
group by nm_artis
having count(film.nm_film) = (select max(Q.C) from (select count(film.nm_film) AS C from film 
right join artis on film.artis = artis.kd_artis 
group by nm_artis) AS Q)

--24 tampilkan negara mana yg paling banyak filmnya
select negara.nm_negara, count(film.nm_film) from film 
join artis on film.artis = artis.kd_artis 
join negara on artis.negara = negara.kd_negara
group by negara.nm_negara
having count(film.nm_film) = (select max(Q.C) from (select count(film.nm_film) AS C from film 
right join artis on film.artis = artis.kd_artis 
group by nm_artis) AS Q)


--view
create view artisbanyakfilm as
select artis.nm_artis,count(film.nm_film) from film 
right join artis on film.artis = artis.kd_artis 
group by nm_artis
having count(film.nm_film) = (select max(Q.C) from (select count(film.nm_film) AS C from film 
right join artis on film.artis = artis.kd_artis 
group by nm_artis) AS Q)

--call view
select * from artisbanyakfilm